---
title: "Pub-Sub"
date: "2025-12-05"
description: "A fault-tolerant distributed publish-subscribe messaging system implementing five distributed algorithms including gossip protocols and Chandy-Lamport snapshots for state recovery."
tech: ["Python", "TCP Sockets", "AWS EC2"]
---

<div className="flex flex-wrap items-center gap-3 not-prose mb-6">
  <a href="https://github.com/krishmula/pub-sub" target="_blank" className="inline-flex items-center gap-2 px-3 py-1.5 text-sm rounded-md bg-highlight border border-muted text-foreground hover:border-foreground/30 transition-colors no-underline">
    <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg>
    GitHub
  </a>
  <span className="inline-flex items-center gap-2 px-3 py-1.5 text-sm rounded-md border border-dashed border-muted/50 text-muted-foreground/50 cursor-not-allowed">
    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
    Live Demo Coming Soon
  </span>
</div>

A distributed publish-subscribe system built for my CS 249 Distributed Systems course that demonstrates core concepts in fault tolerance, message dissemination, and consistent state capture across networked nodes.

Publishers broadcast messages containing integer payloads (0-255), which brokers disseminate through a mesh topology using gossip protocols. Subscribers register for specific payload ranges and receive content-filtered messages through their connected broker.

## Distributed Algorithms Implemented

- **Gossip Protocol** — Epidemic message dissemination with configurable fanout and TTL
- **Chandy-Lamport Snapshots** — Consistent global state capture for fault recovery
- **Leader Election** — Lexicographic ordering to coordinate snapshot initiation
- **Resource Discovery** — Bootstrap server for dynamic peer discovery
- **Agreement Protocol** — ACK-based subscription confirmation

## Fault Tolerance Features

- **Heartbeat-based failure detection** with 15-second timeout threshold
- **k=2 snapshot replication** ensuring state survives broker failures
- **Automatic recovery protocol** where replacement brokers retrieve snapshots from surviving peers
- **Subscriber reconnection** via recovery notifications after broker failover

## Architecture

Brokers form a fully-connected mesh and maintain persistent TCP connections. When a broker fails, surviving peers detect the timeout, and a replacement broker can request the dead broker's last snapshot, restore its subscriber registry, and notify subscribers to update their connection.

## Tech Stack

<div className="flex flex-wrap gap-2 not-prose">
  <span className="px-3 py-1 text-sm rounded-full bg-highlight text-foreground border border-muted">Python 3.13+</span>
  <span className="px-3 py-1 text-sm rounded-full bg-highlight text-foreground border border-muted">TCP Sockets</span>
  <span className="px-3 py-1 text-sm rounded-full bg-highlight text-foreground border border-muted">AWS EC2</span>
  <span className="px-3 py-1 text-sm rounded-full bg-highlight text-foreground border border-muted">Tailscale VPN</span>
  <span className="px-3 py-1 text-sm rounded-full bg-highlight text-foreground border border-muted">GitHub Actions CI/CD</span>
</div>

## What I Built

My contributions focused on the networking layer, broker implementation, Chandy-Lamport snapshot protocol, replication mechanisms, and AWS deployment automation. I implemented the TCP connection management, gossip message handling, failure detection, and the complete snapshot-based recovery flow.